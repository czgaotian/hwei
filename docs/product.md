# 博客 CMS 产品文档

## 1. 产品背景 & 目标

### 1.1 背景

个人博客需要一个轻量、可扩展、完全基于 Cloudflare 基础设施的 CMS，用于统一管理博客文章以及静态资源。

### 1.2 产品目标

- 提供一个**单管理员**使用的博客内容管理系统
- 支持博客文章的完整 CRUD 生命周期
- 支持文章中引用的静态资源（图片 / 文件等）
- 架构清晰，适合长期维护与扩展

---

## 2. 用户与权限模型

### 2.1 用户类型

- **管理员（Admin）**
  - 当前版本仅支持一个管理员用户
  - 不支持注册、角色管理

### 2.2 权限说明

管理员拥有系统内全部权限：

- 文章管理
- 标签管理
- 分类管理
- 静态资源管理

---

### 2.3 认证方式

- 详细设计请参见 @docs/auth.md

### 2.4 管理员注册

- 初次访问系统时，需通过页面初始化管理员账号
- 后续通过登录页面进行身份验证

## 3. 核心功能模块

## 3.1 博客文章管理（Article）

### 3.1.1 功能说明

管理员可以创建、编辑、删除、查看博客文章。

### 3.1.2 文章数据结构

- 标题
- 摘要（可选）
- 正文（使用 Tiptap 富文本编辑器，存储为 HTML）
- 状态（Draft / Published）
- 分类
- 标签（多对多关系）
- 创建时间 / 更新时间

### 3.1.3 CRUD 行为

- 创建文章
- 编辑文章元信息
- 删除文章（软删除）
- 查询文章列表（支持状态、分类筛选）

---

## 3.2 分类管理（Category）

### 功能

- 创建分类
- 编辑分类名称
- 删除分类
- 分类可被文章引用

### 特点

- 一个文章只能属于一个分类
- 分类支持设置颜色（用于前端展示）
- 分类被文章引用时不可直接删除

---

## 3.3 标签管理（Tag）

### 功能

- 创建标签
- 编辑标签名称
- 删除标签

### 特点

- 标签与文章为多对多关系
- 标签支持设置颜色（用于前端展示）

---

## 3.4 静态资源管理（Media）

### 3.4.1 资源类型

- image
- video
- audio
- file

### 3.4.2 功能

- 上传静态资源
- 查看资源列表
- 删除资源
- 获取可访问 URL

### 3.4.3 存储原则

- **文件本体存储在 Cloudflare R2**
- **数据库仅存储资源元数据**

---

## 4. REST API 设计原则

### 4.1 风格约定

- 使用标准 REST 风格 API
- 资源导向（名词，不使用动词）
- 使用 HTTP Method 表达行为

```text
GET    查询
POST   创建
PUT    幂等更新
PATCH  局部更新
DELETE 删除
```

### 4.2 资源层级设计

- articles
- categories
- tags
- media

---

## 5. 非功能性需求

### 5.1 性能

- 运行在 Cloudflare Workers
- API 响应时间尽量 < 100ms（不含网络）

### 5.2 可维护性

- 前后端完全分离
- 严格类型约束（TypeScript + Drizzle ORM）

### 5.3 扩展性

- 未来可扩展多管理员
- 可扩展评论系统、权限系统

---

## 6. 技术选型

### 6.1 前端

- React
- TypeScript（strict）
- Ant Design
- Tiptap：富文本编辑器（文章内容编辑，支持格式化、链接、图片等）

### 6.2 后端

- Hono
- REST API
- 运行环境：Cloudflare Workers

### 6.3 数据库

- Cloudflare D1（SQLite）
- ORM：Drizzle ORM

### 6.4 静态资源

- Cloudflare R2
- 通过 object key + URL 访问

---

## 7. 数据模型

- 详细实现与设计请参见 @docs/database.md

## 8. Cloudflare 部署与约束

### 8.1 Worker 约束

- 无文件系统
- 无长连接
- 所有 I/O 通过 D1 / R2

### 8.2 Wrangler

- 使用 wrangler.json
- 区分 dev / prod 环境
- 每个环境独立的 D1 与 R2

---

## 9. 当前不在范围内

- 多用户 / 多角色系统
- 评论系统
- 博客前台展示

---

## 10. 成功标准

- 管理员可完成博客完整管理流程
- 可稳定运行在 Cloudflare 平台
- 可作为长期维护的博客 CMS 使用
